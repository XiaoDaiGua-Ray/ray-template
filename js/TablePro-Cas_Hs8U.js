import{p as Y,R as Z}from"./props-CsmlPjfV.js";import{O as ee,I as te,J as ae,P as oe,Q as ue,t as M,T as ne}from"./hooks-BY0i9Xdx.js";import"./currency.js@2.0.4-9OAR_aOO.js";import{f as V,j as se}from"./utils-CsGRTM5U.js";import{d as z}from"./dayjs@1.11.10-D8VSY-p2.js";import"./print-js@1.6.0-BdoEj60G.js";import"./jsbarcode@3.11.6-DGNGFp02.js";import{l as W,j as re,f as ie,k as le,b as e,t as ce,v as X,F as me,I as m}from"./@vue_runtime-core@3.5.12-BCEn0y7C.js";import{a as de}from"./vue-hooks-plus@2.2.1_vue@3.5.12-yAzEj4tO.js";import"./js-cookie@3.0.5-Z_8Sd105.js";import"./lodash@4.17.21-Cw59kuJw.js";import"./screenfull@5.2.0-DmMZCkhi.js";import"./instance-D_ZLBlAV.js";import{M as _}from"./mockjs@1.1.0-CxlURkif.js";import{ah as U,R as J,G as pe,ai as fe,c as B,O as p,N as $,K as Q,aj as H,am as I,v as ge}from"./naive-ui@2.40.1_vue@3.5.12-CG3Ec5yr.js";import{k as E}from"./@vue_reactivity@3.5.12-Bs6EYLxJ.js";import"./lodash-es@4.17.21-CeZG2a4n.js";import"./@vueuse_core@11.1.0_vue@3.5.12-D9AYbYsb.js";import"./@vueuse_shared@11.1.0_vue@3.5.12-Bgfs3HCB.js";import"./interactjs@1.10.26-DZL_TZzP.js";import"./call-bind@1.0.7-Cpj98o6Y.js";import"./pinia-plugin-persistedstate@4.1.1_pinia@2.2.4-_Zka_ujQ.js";import"./destr@2.0.3-CVtkxrq9.js";import"./deep-pick-omit@1.2.1-CegYQlcN.js";import"./pinia@2.2.4_typescript@5.2.2_vue@3.5.12-C6kQ2NMt.js";import"./vue-demi@0.14.10_vue@3.5.12-Dq6ymT-8.js";import"./html-to-image@1.11.11-BOFdlgi9.js";import"./vue-router@4.3.2_vue@3.5.12-C0be5zoh.js";import"./vue-i18n@9.13.1_vue@3.5.12-DVHJIodq.js";import"./@intlify_shared@9.13.1-BxU0OzX2.js";import"./@intlify_core-base@9.13.1-C6DqbPB6.js";import"./@intlify_message-compiler@9.13.1-GrLDMuy_.js";import"./echarts@5.5.0-CezqL3m-.js";import"./zrender@5.5.0-DW8ownf1.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./@vue_runtime-dom@3.5.12-DggYGzzI.js";import"./@vue_shared@3.5.12--5_uv9t5.js";import"./axios@1.7.5-C8DqakIB.js";import"./date-fns@3.6.0-q9PkOyxq.js";import"./seemly@0.3.8-DjGKl9dV.js";import"./vueuc@0.4.64_vue@3.5.12-Bw8aTbAe.js";import"./evtd@0.2.4-CI_DDEu_.js";import"./@css-render_vue3-ssr@0.15.14_vue@3.5.12-bUd6r0cI.js";import"./vooks@0.2.12_vue@3.5.12-CqIGVsaf.js";import"./vdirs@0.1.8_vue@3.5.12-C0KV5pCE.js";import"./@juggle_resize-observer@3.4.0-C8OzoCMD.js";import"./css-render@0.15.14-C5toWlUr.js";import"./@emotion_hash@0.8.0-WldOFDRm.js";import"./treemate@0.3.11-DKekKYbv.js";import"./date-fns-tz@3.1.3_date-fns@3.6.0-ztskLDQQ.js";import"./async-validator@4.2.5-DKvM95Vc.js";import"./@css-render_plugin-bem@0.15.14_css-render@0.15.14-Be8eOoM-.js";function ye(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!X(o)}const Re=W({name:"RTablePro",props:Y,setup(o){const[y,{clearFilters:R,clearSorter:d,downloadCsv:k,filters:i,page:s,scrollTo:C,sort:b,print:D,filter:T}]=ee(),[w,{getPage:F,getPageSize:S,setCallback:K,setItemCount:A,resetPagination:v,getItemCount:u}]=te(void 0,{prefix:t=>`共 ${t.itemCount} 条`}),f=re(()=>o.request),j=()=>({getItemCount:u,getPage:F,getPageSize:S}),h=()=>{const{onTablePaginationUpdate:t}=o;t&&V(t,j())},N=t=>{const r=Object.assign({},o.requestConfig,t),{params:a,formatRangeTime:n}=r;return n!=null&&n.length&&a&&n.forEach(q=>{const{key:P,target:c}=q,l=a[P];if(l&&(c!=null&&c.length)){const[L,g]=l;a[c[0]]=L,a[c[1]]=g}else a[P]=null,a[c[0]]=null,a[c[1]]=null}),Object.assign({},a,{page:F(),pageSize:S()})},x=t=>{var a;v();const r=N(t);(a=f.value)==null||a.call(f,r)},G=t=>{var a;const r=N(t);(a=f.value)==null||a.call(f,r)};return ie(()=>{A(o.paginationCount),K(()=>{const{manual:t}=o;t||G(),h()})}),le(()=>{const{onRegister:t}=o;t&&V(t,{getTablePagination:j,runTableRequest:x,clearFilters:R,clearSorter:d,downloadCsv:k,filters:i,page:s,scrollTo:C,sort:b,print:D,filter:T,getCurrentTableRequestParams:N})}),{register:y,paginationRef:w}},render(){const{register:o,$props:y,paginationRef:R,$slots:d}=this,{onRegister:k,showPagination:i,...s}=y;return e(ae,ce(s,{onRegister:o,pagination:i?R:void 0}),ye(d)?d:{default:()=>[d]})}});function ke(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!X(o)}const Rt=W({name:"TableProDemo",setup(){const{format:o}=ne(),[y,{runTableRequest:R,getCurrentTableRequestParams:d,print:k,downloadCsv:i}]=oe(),s=E([]),C=[{type:"selection"},{title:"Name",key:"name"},{title:"Sign Status",key:"statusText"},{title:"Sign Time",key:"signTimeStart",render:t=>o(t.signTimeStart)+" ~ "+o(t.signTimeEnd)},{title:"Age",key:"age"},{title:"Address",key:"address"},{title:"Tags",key:"tags",render:t=>t.tags.map(a=>e(ge,{type:"info",bordered:!1,style:"margin-right: 6px"},ke(a)?a:{default:()=>[a]}))},{title:"Remark",key:"remark"}],b=E(0),D=E({}),T=E((()=>{const r=[],a=z().valueOf();for(let n=0;n<30;n++)r.push({key:se(),name:_.Random.cname(),age:n+20,address:_.Random.city(),tags:["nice","developer"],remark:"我是一条很长很长的备注",status:n%2===0?"success":"error",statusText:n%2===0?"在线":"离线",signTimeStart:z(a).add(n*2,"year").valueOf(),signTimeEnd:z(a).add(n+5,"day").valueOf()});return r})()),w=E({pagination:!0,manual:!1}),[F,{checkedRowKeysBind:S,getKeys:K,getRows:A,clearKey:v,clearAll:u,selectKey:f}]=ue(s,C,{rowKey:"key",onChange:(t,r,a)=>{}}),j=E(!0),h=t=>t==null,N=t=>new Promise(r=>{const{page:a=1,pageSize:n=10,name:O,status:q,signTimeStart:P,signTimeEnd:c}=t||{};let l=T.value;const L=T.value.length;O&&(l=l.filter(g=>g.name.includes(O))),q&&(l=l.filter(g=>g.status===q)),P&&c&&(l=l.filter(g=>g.signTimeStart>=P&&g.signTimeEnd<=c)),l=l.slice((a-1)*n,a*n),setTimeout(()=>{r({code:0,data:l,total:h(q)&&h(O)&&(h(P)||h(c))?L:l.length,message:"success",page:a,pageSize:n})},1e3)}),{run:x,loading:G}=de(N,{onSuccess:t=>{const{data:r,total:a}=t;s.value=r,b.value=a}});return{tableDataRef:s,baseColumns:C,itemCountRef:b,loadingGetPersonList:G,runGetPersonList:x,conditionRef:D,radioRef:w,runTableRequest:R,tableProRegister:y,print:k,downloadCsv:i,checkedRowKeysBind:S,checkedRowKeys:F,getKeys:K,getRows:A,clearKey:v,clearAll:u,collapseRef:j,selectKey:f}},render(){const{tableDataRef:o,baseColumns:y,itemCountRef:R,loadingGetPersonList:d,runGetPersonList:k,conditionRef:i,radioRef:s,runTableRequest:C,tableProRegister:b,print:D,downloadCsv:T,checkedRowKeysBind:w,getKeys:F,getRows:S,clearKey:K,clearAll:A,selectKey:v}=this;return e(B,{vertical:!0},{default:()=>[e(Z,{open:this.collapseRef,bordered:!0},{default:()=>e(me,null,[e(U,{label:"用户名"},{default:()=>[e(J,{value:i.name,"onUpdate:value":u=>i.name=u,clearable:!0},null)]}),e(U,{label:"状态"},{default:()=>[e(pe,{value:i.status,"onUpdate:value":u=>i.status=u,clearable:!0,options:[{label:"成功",value:"success"},{label:"失败",value:"error"}]},null)]}),e(U,{label:"登陆时间"},{default:()=>[e(fe,{type:"datetimerange",value:i.RangeTime,"onUpdate:value":u=>i.RangeTime=u,clearable:!0},null)]}),e(U,{label:"演示折叠的条件框"},{default:()=>[e(J,{readonly:!0,placeholder:"我只是为了占位"},null)]})]),action:()=>e(B,null,{default:()=>[e(p,{type:"primary",onClick:()=>C(),loading:d},{default:()=>[m("查询")]})]}),collapse:u=>u?e(p,{onClick:()=>this.collapseRef=!0,secondary:!0},{default:()=>"受控展开",icon:()=>e(M,{name:"dark",size:"18"},null)}):e(p,{onClick:()=>this.collapseRef=!1,secondary:!0},{default:()=>"受控收起",icon:()=>e(M,{name:"light",size:"18"},null)})}),e($,{title:"常用高级拓展功能"},{default:()=>[e(B,null,{default:()=>[e(Q,{label:"分页"},{default:()=>[e(H,{value:s.pagination,"onUpdate:value":u=>s.pagination=u},{default:()=>[e(I,{value:!0},{default:()=>[m("显示分页")]}),e(I,{value:!1},{default:()=>[m("隐藏分页")]})]})]}),e(Q,{label:"自动更新"},{default:()=>[e(H,{value:s.manual,"onUpdate:value":u=>s.manual=u},{default:()=>[e(I,{value:!1},{default:()=>[m("自动更新")]}),e(I,{value:!0},{default:()=>[m("取消自动")]})]})]})]})]}),e($,{title:"useTablePro 部分方法"},{default:()=>[e(B,null,{default:()=>[e(p,{type:"primary",onClick:()=>D()},{default:()=>[m("打印")]}),e(p,{type:"primary",onClick:()=>T()},{default:()=>[m("下载 csv")]})]})]}),e($,{title:"useCheckedRowKeys 部分方法"},{default:()=>[e(B,null,{default:()=>[e(p,{type:"primary",onClick:()=>{const u=o[1].key;v(u)}},{default:()=>[m("选中第二行")]}),e(p,{type:"primary",onClick:()=>{const u=o[1].key;K(u)}},{default:()=>[m("取消选中第二行")]}),e(p,{type:"primary",onClick:()=>{o==null||o.forEach(u=>v(u.key))}},{default:()=>[m("选中当前页面所有行")]}),e(p,{type:"primary",onClick:()=>{A()}},{default:()=>[m("取消所有已选中行")]})]})]}),e(Re,{onRegister:b,data:o,columns:y,loading:d,paginationCount:R,request:k,requestConfig:{params:i,formatRangeTime:[{key:"RangeTime",target:["signTimeStart","signTimeEnd"]}]},showPagination:s.pagination,manual:s.manual,rowKey:u=>u.key,checkedRowKeys:this.checkedRowKeys,"onUpdate:checkedRowKeys":u=>this.checkedRowKeys=u,onUpdateCheckedRowKeys:w},null)]})}});export{Rt as default};
