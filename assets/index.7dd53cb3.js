var p=Object.defineProperty;var c=(e,t,s)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var u=(e,t,s)=>(c(e,typeof t!="symbol"?t+"":t,s),s);import{a as m}from"./axios.754b77ca.js";import{C as o,M as h,q as y,H as g,F as q,R,E as f}from"./naive-ui.7944048f.js";import{e as C,E as w,h as v,M as D,ao as n,c as b}from"./@vue.6f9b3ecc.js";import"./form-data.2b153385.js";import"./date-fns.03faffa8.js";import"./vueuc.feb70412.js";import"./evtd.9eee5233.js";import"./seemly.786de437.js";import"./@css-render.66179467.js";import"./vooks.d8957d1b.js";import"./vdirs.9b78243b.js";import"./@juggle.32c34d6c.js";import"./css-render.20ab466e.js";import"./@emotion.6322e2ae.js";import"./lodash-es.474663c3.js";import"./treemate.80cdf2c2.js";import"./date-fns-tz.974adeb4.js";import"./async-validator.fb49d0f5.js";class E{constructor(){u(this,"pendingRequest");this.pendingRequest=new Map}generateRequestKey(t){const{method:s,url:a}=t;return[a||"",s||"",JSON.stringify(t.params),JSON.stringify(t.data)].join("&")}addPendingRequest(t){const s=this.generateRequestKey(t);if(this.pendingRequest.has(s))t.signal=this.pendingRequest.get(s).signal;else{const a=new AbortController;t.signal=a.signal,this.pendingRequest.set(s,a)}}removePendingRequest(t){const s=this.generateRequestKey(t);this.pendingRequest.has(s)&&(this.pendingRequest.get(s).abort(),this.pendingRequest.delete(s))}}const i=new E,N=(e,t)=>{const s=e.headers;t.forEach(a=>{s[a.key]=a.value})},r=m.create({baseURL:"",withCredentials:!1,timeout:5*1e3,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>(N(e,[{key:"X-TOKEN",value:"token"}]),i.removePendingRequest(e),i.addPendingRequest(e),e),e=>Promise.reject(e));r.interceptors.response.use(e=>{i.removePendingRequest(e.config);const{data:t}=e;return Promise.resolve(t)},e=>(i.removePendingRequest(e.config||{}),Promise.reject(e)));const P=e=>{const t=Object.assign({},e,{});return r(t)},l=async e=>P({method:"get",url:`https://www.tianqiapi.com/api?version=v9&appid=23035354&appsecret=8YvlPNrz&city=${e}`}),X=C({name:"Axios",setup(){const e=w({weatherData:[],inputCityValue:""}),t=[{title:"\u7A7A\u6C14\u6307\u6570",key:"air"},{title:"\u98CE\u901F",key:"win_meter"},{title:"\u80FD\u89C1\u5EA6",key:"visibility"},{title:"\u5929\u6C14\u60C5\u51B5",key:"wea_day"},{title:"\u63D0\u793A",key:"air_tips"}],s=async a=>{const d=await l(a);e.weatherData=d.data};return v(async()=>{const a=await l("\u6210\u90FD");e.weatherData=a.data}),{...D(e),columns:t,handleInputCityValue:s}},render(){return n(f,null,{default:()=>[n(o,{bordered:!0},{default:()=>[n(h,{title:"\u8BF7\u6C42\u51FD\u6570"},{default:()=>[b("\u57FA\u4E8E axios \u5C01\u88C5, \u80FD\u591F\u81EA\u52A8\u53D6\u6D88\u8FDE\u7EED\u8BF7\u6C42, \u907F\u514D\u91CD\u590D\u6E32\u67D3\u9020\u6210\u95EE\u9898.")]})]}),n(o,{bordered:!0},{default:()=>[n(y,{class:"axios-header__btn",align:"center",justify:"space-between"},{default:()=>[n(g,{value:this.inputCityValue,"onUpdate:value":e=>this.inputCityValue=e,onInput:this.handleInputCityValue.bind(this),placeholder:"\u8BF7\u8F93\u5165\u57CE\u5E02"},null)]})]}),n(q,null,{default:()=>[n(R,{data:this.weatherData,columns:this.columns},null)]})]})}});export{X as default};
